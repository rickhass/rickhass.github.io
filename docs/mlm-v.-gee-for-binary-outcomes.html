<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 MLM v. GEE for Binary Outcomes | Generalized Linear Mixed Models with R: A tutorial</title>
  <meta name="description" content="12 MLM v. GEE for Binary Outcomes | Generalized Linear Mixed Models with R: A tutorial" />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="12 MLM v. GEE for Binary Outcomes | Generalized Linear Mixed Models with R: A tutorial" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 MLM v. GEE for Binary Outcomes | Generalized Linear Mixed Models with R: A tutorial" />
  
  
  

<meta name="author" content="Rick Hass" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multilevel-logistic-regression.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="1" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>1</b> R Basics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="r-basics.html"><a href="r-basics.html#what-is-coding"><i class="fa fa-check"></i><b>1.1</b> What is “coding”</a></li>
<li class="chapter" data-level="1.2" data-path="r-basics.html"><a href="r-basics.html#r-console-versus-the-rstudio-script"><i class="fa fa-check"></i><b>1.2</b> R Console versus the RStudio Script</a></li>
<li class="chapter" data-level="1.3" data-path="r-basics.html"><a href="r-basics.html#working-with-data"><i class="fa fa-check"></i><b>1.3</b> Working with data</a></li>
<li class="chapter" data-level="1.4" data-path="r-basics.html"><a href="r-basics.html#using-a-script-to-generate-data-and-computing-the-mean-and-standard-deviation"><i class="fa fa-check"></i><b>1.4</b> Using a script to generate data, and computing the mean and standard deviation</a></li>
<li class="chapter" data-level="1.5" data-path="r-basics.html"><a href="r-basics.html#importing-data"><i class="fa fa-check"></i><b>1.5</b> Importing Data</a></li>
<li class="chapter" data-level="1.6" data-path="r-basics.html"><a href="r-basics.html#reading-in-an-spss-file"><i class="fa fa-check"></i><b>1.6</b> Reading in an SPSS file</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="r-basics.html"><a href="r-basics.html#a-quick-note-on-indexing"><i class="fa fa-check"></i><b>1.6.1</b> A quick note on indexing</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="r-basics.html"><a href="r-basics.html#frequencies-and-contingency-tables"><i class="fa fa-check"></i><b>1.7</b> Frequencies and Contingency Tables</a></li>
<li class="chapter" data-level="1.8" data-path="r-basics.html"><a href="r-basics.html#descriptive-statistics"><i class="fa fa-check"></i><b>1.8</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="r-basics.html"><a href="r-basics.html#the-describe-function"><i class="fa fa-check"></i><b>1.8.1</b> The describe function</a></li>
<li class="chapter" data-level="1.8.2" data-path="r-basics.html"><a href="r-basics.html#the-describeby-function"><i class="fa fa-check"></i><b>1.8.2</b> The describeBy function</a></li>
<li class="chapter" data-level="1.8.3" data-path="r-basics.html"><a href="r-basics.html#computing-a-new-variable-and-adding-it-to-the-dataframe"><i class="fa fa-check"></i><b>1.8.3</b> Computing a new variable and adding it to the dataframe</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="r-basics.html"><a href="r-basics.html#visualizing-data"><i class="fa fa-check"></i><b>1.9</b> Visualizing Data</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="r-basics.html"><a href="r-basics.html#histograms-and-density-plots"><i class="fa fa-check"></i><b>1.9.1</b> Histograms and density plots</a></li>
<li class="chapter" data-level="1.9.2" data-path="r-basics.html"><a href="r-basics.html#boxplots"><i class="fa fa-check"></i><b>1.9.2</b> Boxplots</a></li>
<li class="chapter" data-level="1.9.3" data-path="r-basics.html"><a href="r-basics.html#scatterplots"><i class="fa fa-check"></i><b>1.9.3</b> Scatterplots</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="r-basics.html"><a href="r-basics.html#review"><i class="fa fa-check"></i><b>1.10</b> Review</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html"><i class="fa fa-check"></i><b>2</b> Ordinary Linear Regression</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#our-data"><i class="fa fa-check"></i><b>2.1</b> Our data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#converting-from-numeric-to-factor"><i class="fa fa-check"></i><b>2.1.1</b> Converting from numeric to factor</a></li>
<li class="chapter" data-level="2.1.2" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#confidence-intervals-v.-p-values"><i class="fa fa-check"></i><b>2.1.2</b> Confidence Intervals v. p-values</a></li>
<li class="chapter" data-level="2.1.3" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#adding-interaction-terms"><i class="fa fa-check"></i><b>2.1.3</b> Adding interaction terms</a></li>
<li class="chapter" data-level="2.1.4" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#interaction-model-for-gambling"><i class="fa fa-check"></i><b>2.1.4</b> Interaction model for Gambling</a></li>
<li class="chapter" data-level="2.1.5" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#interaction-output"><i class="fa fa-check"></i><b>2.1.5</b> Interaction Output</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#anova-and-drop1-commands"><i class="fa fa-check"></i><b>2.2</b> ANOVA and drop1 commands</a></li>
<li class="chapter" data-level="2.3" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#plots"><i class="fa fa-check"></i><b>2.3</b> Plots</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>3</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#an-example-diabetes-risk-factors"><i class="fa fa-check"></i><b>3.1</b> An Example: Diabetes risk factors</a></li>
<li class="chapter" data-level="3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#model-discrimination-and-fit"><i class="fa fa-check"></i><b>3.2</b> Model Discrimination and Fit</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="logistic-regression.html"><a href="logistic-regression.html#roc-and-auroc"><i class="fa fa-check"></i><b>3.2.1</b> ROC and AUROC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regression-with-counts-as-outcomes.html"><a href="regression-with-counts-as-outcomes.html"><i class="fa fa-check"></i><b>4</b> Regression with Counts as Outcomes</a>
<ul>
<li class="chapter" data-level="4.1" data-path="regression-with-counts-as-outcomes.html"><a href="regression-with-counts-as-outcomes.html#example-data-phmc-fruits-question"><i class="fa fa-check"></i><b>4.1</b> Example data: PHMC Fruits question</a></li>
<li class="chapter" data-level="4.2" data-path="regression-with-counts-as-outcomes.html"><a href="regression-with-counts-as-outcomes.html#coefficients-in-poisson-models"><i class="fa fa-check"></i><b>4.2</b> Coefficients in Poisson Models</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="regression-with-counts-as-outcomes.html"><a href="regression-with-counts-as-outcomes.html#exponentiated-coefficients-interpretation"><i class="fa fa-check"></i><b>4.2.1</b> Exponentiated Coefficients Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="regression-with-counts-as-outcomes.html"><a href="regression-with-counts-as-outcomes.html#overdispersion-and-other-count-regression-models"><i class="fa fa-check"></i><b>4.3</b> Overdispersion and other count regression models</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="regression-with-counts-as-outcomes.html"><a href="regression-with-counts-as-outcomes.html#overdispersion-and-zero-inflation"><i class="fa fa-check"></i><b>4.3.1</b> Overdispersion and Zero-inflation</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="regression-with-counts-as-outcomes.html"><a href="regression-with-counts-as-outcomes.html#zero-inflated-models"><i class="fa fa-check"></i><b>4.4</b> Zero-inflated models</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html"><i class="fa fa-check"></i><b>5</b> Model Fit and Assumptions for GLMs</a>
<ul>
<li class="chapter" data-level="5.1" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#model-checking-and-diagnostics-in-ordinary-least-squares"><i class="fa fa-check"></i><b>5.1</b> Model Checking and Diagnostics in Ordinary Least Squares</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#residuals-v.-fitted-values"><i class="fa fa-check"></i><b>5.1.1</b> Residuals v. Fitted Values</a></li>
<li class="chapter" data-level="5.1.2" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#normalty-of-residuals"><i class="fa fa-check"></i><b>5.1.2</b> Normalty of residuals</a></li>
<li class="chapter" data-level="5.1.3" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#leverage"><i class="fa fa-check"></i><b>5.1.3</b> Leverage</a></li>
<li class="chapter" data-level="5.1.4" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#influence"><i class="fa fa-check"></i><b>5.1.4</b> Influence</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#model-checking-and-diagnostics-in-logistic-regression"><i class="fa fa-check"></i><b>5.2</b> Model Checking and Diagnostics in Logistic Regression</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#hosmer-lemeshow-test"><i class="fa fa-check"></i><b>5.2.1</b> Hosmer-Lemeshow Test</a></li>
<li class="chapter" data-level="5.2.2" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#nagelkerkes-pseudo-r-squared"><i class="fa fa-check"></i><b>5.2.2</b> Nagelkerke’s pseudo R-squared</a></li>
<li class="chapter" data-level="5.2.3" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#residuals-and-leverages"><i class="fa fa-check"></i><b>5.2.3</b> Residuals and leverages</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#summary"><i class="fa fa-check"></i><b>5.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html"><i class="fa fa-check"></i><b>6</b> Introducing mixed-models and the lme4 package</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#options-in-r"><i class="fa fa-check"></i><b>6.1</b> Options in R</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#why-lme4"><i class="fa fa-check"></i><b>6.1.1</b> Why lme4?</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#a-possible-workflow"><i class="fa fa-check"></i><b>6.2</b> A possible workflow</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#high-school-and-beyond"><i class="fa fa-check"></i><b>6.2.1</b> High School and Beyond</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#model-1-one-way-random-effects-anova-using-reml"><i class="fa fa-check"></i><b>6.3</b> Model 1: one-way random-effects ANOVA using REML</a></li>
<li class="chapter" data-level="6.4" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#quasi-anova-estimator"><i class="fa fa-check"></i><b>6.4</b> Quasi-ANOVA estimator</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#unrestricted-maximum-likelihood"><i class="fa fa-check"></i><b>6.4.1</b> (unrestricted) Maximum Likelihood</a></li>
<li class="chapter" data-level="6.4.2" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#intraclass-correlation"><i class="fa fa-check"></i><b>6.4.2</b> Intraclass correlation</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#bootstrapped-confidence-intervals"><i class="fa fa-check"></i><b>6.5</b> Bootstrapped confidence intervals</a></li>
<li class="chapter" data-level="6.6" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#linear-mixed-effects"><i class="fa fa-check"></i><b>6.6</b> Linear mixed-effects</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#random-effects-estimates"><i class="fa fa-check"></i><b>6.6.1</b> Random effects estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html"><i class="fa fa-check"></i><b>7</b> Mixed models as Hierarchical Linear Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html#high-school-and-beyond-data"><i class="fa fa-check"></i><b>7.1</b> High School and Beyond Data</a></li>
<li class="chapter" data-level="7.2" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html#model-1-unconditional-model"><i class="fa fa-check"></i><b>7.2</b> Model 1: unconditional model</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html#unconditional-icc"><i class="fa fa-check"></i><b>7.2.1</b> Unconditional ICC</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html#means-as-outcomes-binary-predictor"><i class="fa fa-check"></i><b>7.3</b> Means as outcomes: Binary Predictor</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html#means-as-outcomes-continuous-predictor"><i class="fa fa-check"></i><b>7.3.1</b> Means as outcomes: continuous predictor</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html#multiple-hierarchical-linear-regression"><i class="fa fa-check"></i><b>7.4</b> Multiple hierarchical linear regression</a></li>
<li class="chapter" data-level="7.5" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html#plotting-predictor-effects"><i class="fa fa-check"></i><b>7.5</b> Plotting predictor effects</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html"><i class="fa fa-check"></i><b>8</b> More on Hierarchical Linear Models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#overview-1"><i class="fa fa-check"></i><b>8.1</b> Overview</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#load-the-data"><i class="fa fa-check"></i><b>8.1.1</b> Load the data</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#random-coefficients-model"><i class="fa fa-check"></i><b>8.2</b> Random Coefficients model</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#visualizing-the-within-school-slopes"><i class="fa fa-check"></i><b>8.2.1</b> Visualizing the within-school slopes</a></li>
<li class="chapter" data-level="8.2.2" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#fitting-the-random-coefficients-2-level-model"><i class="fa fa-check"></i><b>8.2.2</b> Fitting the Random Coefficients 2-level model</a></li>
<li class="chapter" data-level="8.2.3" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#adding-additional-level-1-predictors-to-the-random-coefficients-model"><i class="fa fa-check"></i><b>8.2.3</b> Adding additional level-1 predictors to the random coefficients model</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#intercepts-and-slopes-as-outcomes"><i class="fa fa-check"></i><b>8.3</b> Intercepts and Slopes as Outcomes</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#interactions-and-the-iso-model"><i class="fa fa-check"></i><b>8.3.1</b> Interactions and the ISO model</a></li>
<li class="chapter" data-level="8.3.2" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#mean-ses-and-student-ses"><i class="fa fa-check"></i><b>8.3.2</b> Mean SES and Student SES</a></li>
<li class="chapter" data-level="8.3.3" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#sector-and-student-ses"><i class="fa fa-check"></i><b>8.3.3</b> Sector and Student SES</a></li>
<li class="chapter" data-level="8.3.4" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#visualizing-the-mean-ses-effect"><i class="fa fa-check"></i><b>8.3.4</b> Visualizing the mean SES effect</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#model-comparison-with-likelihood-ratios-fixed-and-random"><i class="fa fa-check"></i><b>8.4</b> Model comparison with Likelihood Ratios: Fixed and Random</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#example-1-lrt-for-fixed-effects"><i class="fa fa-check"></i><b>8.4.1</b> Example 1: LRT for fixed effects</a></li>
<li class="chapter" data-level="8.4.2" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#example-2-lrt-for-random-effects"><i class="fa fa-check"></i><b>8.4.2</b> Example 2: LRT for random effects</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#diagnostics"><i class="fa fa-check"></i><b>8.5</b> Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html"><i class="fa fa-check"></i><b>9</b> Using lme4 to fit MLM to longitudinal data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#data-description-average-reaction-time-per-day-for-subjects-in-a-sleep-deprivation-study-belenky-et-al.-2003"><i class="fa fa-check"></i><b>9.1</b> Data description: average reaction time per day for subjects in a sleep deprivation study (Belenky et al. 2003)</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#visualization-of-the-data"><i class="fa fa-check"></i><b>9.1.1</b> Visualization of the data</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#fitting-the-level-1-model"><i class="fa fa-check"></i><b>9.2</b> Fitting the level-1 model</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#model-equations"><i class="fa fa-check"></i><b>9.2.1</b> Model Equations</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#model-building"><i class="fa fa-check"></i><b>9.3</b> Model building</a></li>
<li class="chapter" data-level="9.4" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#model-comparison-and-testing"><i class="fa fa-check"></i><b>9.4</b> Model comparison and testing</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#option-1-using-confidence-intervals"><i class="fa fa-check"></i><b>9.4.1</b> Option 1: using confidence intervals</a></li>
<li class="chapter" data-level="9.4.2" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#tests"><i class="fa fa-check"></i><b>9.4.2</b> Tests</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#quadratic-model-with-lmer"><i class="fa fa-check"></i><b>9.5</b> Quadratic model with lmer</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#a-note-on-quadratic-terms"><i class="fa fa-check"></i><b>9.5.1</b> A note on quadratic terms</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#summary-of-the-sleepstudy-analysis"><i class="fa fa-check"></i><b>9.6</b> Summary of the sleepstudy analysis</a></li>
<li class="chapter" data-level="9.7" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#preview-of-the-blackmore-data-used-for-assignment-7b"><i class="fa fa-check"></i><b>9.7</b> Preview of the Blackmore data used for Assignment 7b</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#a-note-on-the-age-variable-in-blackmore"><i class="fa fa-check"></i><b>9.7.1</b> A note on the age variable in Blackmore</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html"><i class="fa fa-check"></i><b>10</b> Longitudinal models with upper-level predictors</a>
<ul>
<li class="chapter" data-level="10.1" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#overview-2"><i class="fa fa-check"></i><b>10.1</b> Overview</a></li>
<li class="chapter" data-level="10.2" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#part-1-intercepts-and-slopes-as-outcomes"><i class="fa fa-check"></i><b>10.2</b> Part 1: Intercepts and Slopes as Outcomes</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#a-short-tutorial-on-ggplot2"><i class="fa fa-check"></i><b>10.2.1</b> A short tutorial on ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#adding-level-2-predictors"><i class="fa fa-check"></i><b>10.3</b> Adding level 2 predictors</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#transforming-the-exercise-variable"><i class="fa fa-check"></i><b>10.3.1</b> Transforming the Exercise Variable</a></li>
<li class="chapter" data-level="10.3.2" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#steps-1-and-2"><i class="fa fa-check"></i><b>10.3.2</b> Steps 1 and 2:</a></li>
<li class="chapter" data-level="10.3.3" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#step-3"><i class="fa fa-check"></i><b>10.3.3</b> Step 3:</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#summary-1"><i class="fa fa-check"></i><b>10.4</b> Summary</a></li>
<li class="chapter" data-level="10.5" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#adding-level-2-explanatory-variables"><i class="fa fa-check"></i><b>10.5</b> Adding Level-2 Explanatory variables</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#visualizing-the-transformed-data"><i class="fa fa-check"></i><b>10.5.1</b> Visualizing the transformed data</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#time-dependent-covariates"><i class="fa fa-check"></i><b>10.6</b> Time dependent covariates</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#level-1-time-dependent-sports-predictor"><i class="fa fa-check"></i><b>10.6.1</b> Level-1: Time-dependent sports predictor</a></li>
<li class="chapter" data-level="10.6.2" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#level-2-participant-level-indicator-of-sports-participation"><i class="fa fa-check"></i><b>10.6.2</b> Level-2: Participant-level indicator of sports participation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="multilevel-logistic-regression.html"><a href="multilevel-logistic-regression.html"><i class="fa fa-check"></i><b>11</b> Multilevel logistic regression</a>
<ul>
<li class="chapter" data-level="11.1" data-path="multilevel-logistic-regression.html"><a href="multilevel-logistic-regression.html#unconditional-model"><i class="fa fa-check"></i><b>11.1</b> Unconditional model</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="multilevel-logistic-regression.html"><a href="multilevel-logistic-regression.html#fitting-the-model"><i class="fa fa-check"></i><b>11.1.1</b> Fitting the model</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="multilevel-logistic-regression.html"><a href="multilevel-logistic-regression.html#conditional-model"><i class="fa fa-check"></i><b>11.2</b> Conditional model</a></li>
<li class="chapter" data-level="11.3" data-path="multilevel-logistic-regression.html"><a href="multilevel-logistic-regression.html#interpreting-odds-ratios"><i class="fa fa-check"></i><b>11.3</b> Interpreting odds ratios</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html"><i class="fa fa-check"></i><b>12</b> MLM v. GEE for Binary Outcomes</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#overview-3"><i class="fa fa-check"></i><b>12.1</b> Overview</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#dataset"><i class="fa fa-check"></i><b>12.1.1</b> Dataset</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#hlm-model"><i class="fa fa-check"></i><b>12.2</b> HLM Model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#interpreting-odds-ratios-1"><i class="fa fa-check"></i><b>12.2.1</b> Interpreting odds ratios</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#population-average-model-with-gee"><i class="fa fa-check"></i><b>12.3</b> Population Average Model with GEE</a></li>
<li class="chapter" data-level="12.4" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#hlm-with-level-2-predictors"><i class="fa fa-check"></i><b>12.4</b> HLM with level-2 predictors</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#random-slopes-1"><i class="fa fa-check"></i><b>12.4.1</b> Random slopes</a></li>
<li class="chapter" data-level="12.4.2" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#level-2-predictors"><i class="fa fa-check"></i><b>12.4.2</b> Level 2 predictors</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#compare-to-gee"><i class="fa fa-check"></i><b>12.5</b> Compare to GEE</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#visualizing-res"><i class="fa fa-check"></i><b>12.5.1</b> Visualizing REs</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Generalized Linear Mixed Models with R: A tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mlm-v.-gee-for-binary-outcomes" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">12</span> MLM v. GEE for Binary Outcomes<a href="mlm-v.-gee-for-binary-outcomes.html#mlm-v.-gee-for-binary-outcomes" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="overview-3" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Overview<a href="mlm-v.-gee-for-binary-outcomes.html#overview-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Contrast the GEE approach with a simple random effects model with a binary outcome</li>
<li>Illustrate more complex mulilevel glm issues with binary outcomes</li>
</ul>
<p><strong>New package alert!</strong> for generalized estimating equations we’ll use the <code>geepack</code> package</p>
<ul>
<li>You’ll need to install it before using it</li>
</ul>
<div id="dataset" class="section level3 hasAnchor" number="12.1.1">
<h3><span class="header-section-number">12.1.1</span> Dataset<a href="mlm-v.-gee-for-binary-outcomes.html#dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For illustration, we’ll continue to use the <strong>2018 PHMC Survey Dataset</strong></p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="mlm-v.-gee-for-binary-outcomes.html#cb359-1" tabindex="-1"></a>PHMC18 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="fu">url</span>(<span class="st">&quot;https://rickhass.github.io/PHMC18_Data.rds&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="hlm-model" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> HLM Model<a href="mlm-v.-gee-for-binary-outcomes.html#hlm-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Recall last week we modeled ED visit (yes/no) with the following predictors:</p>
<p>Predictors:</p>
<ol style="list-style-type: decimal">
<li>SEX01 (Male / Female)</li>
<li>RESPAGE_4CAT - 4 category age variable</li>
<li>BMI</li>
<li>RESPRACE_4CAT - White, Black, Asian, Other</li>
<li>NPOV100 - indicator for poverty</li>
</ol>
<p>Here are the results on the log-odds scale</p>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
HOSPERA 2
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Log-Odds
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
std. Error
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.16
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
SEX01 [Female]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.13
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.021</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
RESPAGE_4CAT35-49
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.12
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.343
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
RESPAGE_4CAT50-64
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.12
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.246
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
RESPAGE 4CAT [65+]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.01
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.937
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
BMI
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.13
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
RESPRACE 4CAT [Black]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.44
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
RESPRACE 4CAT [Asian]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.25
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.26
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.342
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
RESPRACE 4CAT [Other]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.44
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N <sub>ZIPREGION</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
31
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
6927
</td>
</tr>
</table>
<div id="interpreting-odds-ratios-1" class="section level3 hasAnchor" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> Interpreting odds ratios<a href="mlm-v.-gee-for-binary-outcomes.html#interpreting-odds-ratios-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Remember, the odds ratios here are “cluster specific.” Indeed, the entire model is focused on the individual level, not the cluster level.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="mlm-v.-gee-for-binary-outcomes.html#cb360-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">exp</span>(car<span class="sc">::</span><span class="fu">Confint</span>(cond_mod)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                    Estimate 2.5 % 97.5 %
## (Intercept)           0.314 0.255  0.387
## SEX01Female           1.139 1.020  1.273
## RESPAGE_4CAT35-49     0.894 0.710  1.126
## RESPAGE_4CAT50-64     0.885 0.720  1.088
## RESPAGE_4CAT65+       0.992 0.810  1.215
## scale(BMI)            1.140 1.081  1.202
## RESPRACE_4CATBlack    1.549 1.330  1.805
## RESPRACE_4CATAsian    0.781 0.469  1.301
## RESPRACE_4CATOther    1.545 1.249  1.912</code></pre>
<p>Above, we must now interpret the association between sex and odds of ED visit as follows:</p>
<blockquote>
<p>Holding all other variables constant, and the cluster / random effect constant, females have <span class="math inline">\(12\%\)</span> greater odds of an ED visit compared to males</p>
</blockquote>
<p>This is why the mixed-effects logistic regression is referred to as “cluster-specific” (compared to say, GEE which is a “population average model”)</p>
</div>
</div>
<div id="population-average-model-with-gee" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Population Average Model with GEE<a href="mlm-v.-gee-for-binary-outcomes.html#population-average-model-with-gee" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As we discussed, generalized estimating equations marginalize over the individuals and model the “population average” effect. This is great for our use of odds ratios, but not as good if we want to include more complex random effects</p>
<p>One annoying part here is that we need to supply complete data to the function <code>geeglm</code>, it will not automatically reduce the dataframe for us.</p>
<p>We must also put the observations in order by cluster (<code>ZIPREGION</code>) and change to a 0/1 numeric variable</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="mlm-v.-gee-for-binary-outcomes.html#cb362-1" tabindex="-1"></a>PHMC18<span class="sc">$</span>PHILA <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(PHMC18<span class="sc">$</span>COUNTY <span class="sc">==</span> <span class="st">&quot;Philadelphia&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb362-2"><a href="mlm-v.-gee-for-binary-outcomes.html#cb362-2" tabindex="-1"></a>PHMC18<span class="sc">$</span>PHILA <span class="ot">&lt;-</span> <span class="fu">factor</span>(PHMC18<span class="sc">$</span>PHILA, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Not Phila&quot;</span>,<span class="st">&quot;Phila&quot;</span>))</span>
<span id="cb362-3"><a href="mlm-v.-gee-for-binary-outcomes.html#cb362-3" tabindex="-1"></a></span>
<span id="cb362-4"><a href="mlm-v.-gee-for-binary-outcomes.html#cb362-4" tabindex="-1"></a>PHMC18<span class="sc">$</span>ed_visit <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(PHMC18<span class="sc">$</span>HOSPERA2 <span class="sc">==</span> <span class="st">&quot;0 visits&quot;</span>, <span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb362-5"><a href="mlm-v.-gee-for-binary-outcomes.html#cb362-5" tabindex="-1"></a></span>
<span id="cb362-6"><a href="mlm-v.-gee-for-binary-outcomes.html#cb362-6" tabindex="-1"></a>PHMC18_order <span class="ot">&lt;-</span> PHMC18[<span class="fu">order</span>(PHMC18<span class="sc">$</span>ZIPREGION), ]</span>
<span id="cb362-7"><a href="mlm-v.-gee-for-binary-outcomes.html#cb362-7" tabindex="-1"></a></span>
<span id="cb362-8"><a href="mlm-v.-gee-for-binary-outcomes.html#cb362-8" tabindex="-1"></a>PHMC18_gee <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(PHMC18_order[,<span class="fu">c</span>(<span class="st">&quot;ed_visit&quot;</span>,<span class="st">&quot;SEX01&quot;</span>,<span class="st">&quot;RESPAGE_4CAT&quot;</span>,<span class="st">&quot;BMI&quot;</span>,<span class="st">&quot;RESPRACE_4CAT&quot;</span>,<span class="st">&quot;ZIPREGION&quot;</span>,<span class="st">&quot;PHILA&quot;</span>)])</span></code></pre></div>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="mlm-v.-gee-for-binary-outcomes.html#cb363-1" tabindex="-1"></a>pop_avg <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(ed_visit <span class="sc">~</span> SEX01 <span class="sc">+</span> RESPAGE_4CAT <span class="sc">+</span> <span class="fu">scale</span>(BMI) <span class="sc">+</span> RESPRACE_4CAT, <span class="at">id =</span> ZIPREGION, <span class="at">corstr =</span> <span class="st">&quot;exchangeable&quot;</span>, <span class="at">scale.fix =</span> <span class="cn">TRUE</span>, <span class="at">data =</span> PHMC18_gee, <span class="at">family=</span>binomial)</span>
<span id="cb363-2"><a href="mlm-v.-gee-for-binary-outcomes.html#cb363-2" tabindex="-1"></a></span>
<span id="cb363-3"><a href="mlm-v.-gee-for-binary-outcomes.html#cb363-3" tabindex="-1"></a><span class="fu">summary</span>(pop_avg)</span></code></pre></div>
<pre><code>## 
## Call:
## geeglm(formula = ed_visit ~ SEX01 + RESPAGE_4CAT + scale(BMI) + 
##     RESPRACE_4CAT, family = binomial, data = PHMC18_gee, id = ZIPREGION, 
##     corstr = &quot;exchangeable&quot;, scale.fix = TRUE)
## 
##  Coefficients:
##                     Estimate   Std.err    Wald Pr(&gt;|W|)    
## (Intercept)        -1.149729  0.102404 126.054  &lt; 2e-16 ***
## SEX01Female         0.130091  0.041740   9.714  0.00183 ** 
## RESPAGE_4CAT35-49  -0.111381  0.100455   1.229  0.26753    
## RESPAGE_4CAT50-64  -0.122429  0.099943   1.501  0.22058    
## RESPAGE_4CAT65+    -0.008848  0.092650   0.009  0.92392    
## scale(BMI)          0.130595  0.025419  26.396 2.78e-07 ***
## RESPRACE_4CATBlack  0.437663  0.066523  43.285 4.73e-11 ***
## RESPRACE_4CATAsian -0.246682  0.258178   0.913  0.33934    
## RESPRACE_4CATOther  0.435724  0.093036  21.934 2.82e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation structure = exchangeable 
## Scale is fixed.
## 
##   Link = identity 
## 
## Estimated Correlation Parameters:
##       Estimate  Std.err
## alpha 0.004531 0.002029
## Number of clusters:   31  Maximum cluster size: 410</code></pre>
<p>Comparing with above, we can see that the results are nearly identical. One reason for that can be seen by inspecting the <span class="math inline">\(\alpha\)</span> parameter, estimated to be almost zero. This means there’s very little within-group correlation, so we might as well model this as independent data.</p>
<p>The good news is that the cluster-specific and population average models converge, so we could consider the confidence intervals from the MLM to be accurate.</p>
<p>Here’s the GEE confidence intervals for the odds-ratios</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="mlm-v.-gee-for-binary-outcomes.html#cb365-1" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(pop_avg, <span class="at">conf.int =</span> T, <span class="at">exponentiate =</span> T)</span></code></pre></div>
<pre><code>## # A tibble: 9 × 7
##   term               estimate std.error statistic  p.value conf.low conf.high
##   &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)           0.317    0.102  126.      0           0.259     0.387
## 2 SEX01Female           1.14     0.0417   9.71    1.83e- 3    1.05      1.24 
## 3 RESPAGE_4CAT35-49     0.895    0.100    1.23    2.68e- 1    0.735     1.09 
## 4 RESPAGE_4CAT50-64     0.885    0.0999   1.50    2.21e- 1    0.727     1.08 
## 5 RESPAGE_4CAT65+       0.991    0.0926   0.00912 9.24e- 1    0.827     1.19 
## 6 scale(BMI)            1.14     0.0254  26.4     2.78e- 7    1.08      1.20 
## 7 RESPRACE_4CATBlack    1.55     0.0665  43.3     4.73e-11    1.36      1.76 
## 8 RESPRACE_4CATAsian    0.781    0.258    0.913   3.39e- 1    0.471     1.30 
## 9 RESPRACE_4CATOther    1.55     0.0930  21.9     2.82e- 6    1.29      1.86</code></pre>
</div>
<div id="hlm-with-level-2-predictors" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> HLM with level-2 predictors<a href="mlm-v.-gee-for-binary-outcomes.html#hlm-with-level-2-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Despite the nice properties of the population average approach, it is arguably less suited to situations in which we have random slopes as well as other predictors at level 2</p>
<p>From a philosophical perspective, we would use HLM if our questions were best answered by them</p>
<p>We’ll have a look at two additional models, mirroring our approach in ordinary HLM</p>
<div id="random-slopes-1" class="section level3 hasAnchor" number="12.4.1">
<h3><span class="header-section-number">12.4.1</span> Random slopes<a href="mlm-v.-gee-for-binary-outcomes.html#random-slopes-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You’ll find that things can get quite messy when you try to let all the slopes be random. We’ll stick with one that might make sense:</p>
<ul>
<li>Examine the model fit and <span class="math inline">\(\tau_{11}\)</span> for <code>BMI</code> - it is conceivable that the relationship between BMI and odds of an ED visit might vary across <code>ZIPREGION</code></li>
</ul>
<p>To do this properly, we’ll group-center BMI</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-1" tabindex="-1"></a>bmi <span class="ot">&lt;-</span> PHMC18 <span class="sc">|&gt;</span></span>
<span id="cb367-2"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-2" tabindex="-1"></a>  <span class="fu">group_by</span>(ZIPREGION) <span class="sc">|&gt;</span></span>
<span id="cb367-3"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MeanBMI =</span> <span class="fu">mean</span>(BMI, <span class="at">na.rm =</span> T))</span>
<span id="cb367-4"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-4" tabindex="-1"></a></span>
<span id="cb367-5"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(PHMC18)){</span>
<span id="cb367-6"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-6" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(PHMC18<span class="sc">$</span>BMI[i])){</span>
<span id="cb367-7"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-7" tabindex="-1"></a>    <span class="cf">next</span></span>
<span id="cb367-8"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-8" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb367-9"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-9" tabindex="-1"></a>      s <span class="ot">=</span> PHMC18<span class="sc">$</span>ZIPREGION[i]</span>
<span id="cb367-10"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-10" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">is.na</span>(s)){</span>
<span id="cb367-11"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-11" tabindex="-1"></a>        <span class="cf">next</span></span>
<span id="cb367-12"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-12" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb367-13"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-13" tabindex="-1"></a>        PHMC18<span class="sc">$</span>cBMI[i] <span class="ot">=</span> PHMC18<span class="sc">$</span>BMI[i] <span class="sc">-</span> bmi<span class="sc">$</span>MeanBMI[s]</span>
<span id="cb367-14"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-14" tabindex="-1"></a>      }</span>
<span id="cb367-15"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-15" tabindex="-1"></a>  }</span>
<span id="cb367-16"><a href="mlm-v.-gee-for-binary-outcomes.html#cb367-16" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="mlm-v.-gee-for-binary-outcomes.html#cb368-1" tabindex="-1"></a>rand_sl <span class="ot">&lt;-</span> <span class="fu">glmer</span>(HOSPERA2 <span class="sc">~</span> SEX01 <span class="sc">+</span> RESPAGE_4CAT <span class="sc">+</span> cBMI <span class="sc">+</span> RESPRACE_4CAT <span class="sc">+</span> (cBMI<span class="sc">|</span>ZIPREGION), <span class="at">family =</span> binomial, <span class="at">data =</span> PHMC18)</span>
<span id="cb368-2"><a href="mlm-v.-gee-for-binary-outcomes.html#cb368-2" tabindex="-1"></a></span>
<span id="cb368-3"><a href="mlm-v.-gee-for-binary-outcomes.html#cb368-3" tabindex="-1"></a><span class="fu">summary</span>(rand_sl)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
##  Family: binomial  ( logit )
## Formula: HOSPERA2 ~ SEX01 + RESPAGE_4CAT + cBMI + RESPRACE_4CAT + (cBMI |      ZIPREGION)
##    Data: PHMC18
## 
##       AIC       BIC    logLik -2*log(L)  df.resid 
##      8307      8389     -4141      8283      7196 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -0.969 -0.612 -0.544  1.241  2.392 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev. Corr 
##  ZIPREGION (Intercept) 3.11e-02 0.17649       
##            cBMI        5.15e-06 0.00227  -1.00
## Number of obs: 7208, groups:  ZIPREGION, 31
## 
## Fixed effects:
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)        -1.17684    0.10590  -11.11  &lt; 2e-16 ***
## SEX01Female         0.11885    0.05564    2.14    0.033 *  
## RESPAGE_4CAT35-49  -0.07859    0.11528   -0.68    0.495    
## RESPAGE_4CAT50-64  -0.09463    0.10390   -0.91    0.362    
## RESPAGE_4CAT65+     0.02196    0.10215    0.22    0.830    
## cBMI                0.01947    0.00459    4.24  2.2e-05 ***
## RESPRACE_4CATBlack  0.45496    0.07790    5.84  5.2e-09 ***
## RESPRACE_4CATAsian -0.29957    0.25309   -1.18    0.237    
## RESPRACE_4CATOther  0.44251    0.10693    4.14  3.5e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                (Intr) SEX01F RESPAGE_4CAT3 RESPAGE_4CAT5 RESPAGE_4CAT6 cBMI   RESPRACE_4CATB
## SEX01Female    -0.269                                                                       
## RESPAGE_4CAT3  -0.698 -0.037                                                                
## RESPAGE_4CAT5  -0.786 -0.040  0.716                                                         
## RESPAGE_4CAT6  -0.806 -0.047  0.729         0.818                                           
## cBMI            0.032  0.026 -0.056        -0.088        -0.051                             
## RESPRACE_4CATB -0.171 -0.080  0.009         0.026         0.044        -0.113               
## RESPRACE_4CATA -0.134  0.031  0.055         0.086         0.104         0.011  0.079        
## RESPRACE_4CATO -0.219 -0.023  0.079         0.120         0.152        -0.037  0.258        
##                RESPRACE_4CATA
## SEX01Female                  
## RESPAGE_4CAT3                
## RESPAGE_4CAT5                
## RESPAGE_4CAT6                
## cBMI                         
## RESPRACE_4CATB               
## RESPRACE_4CATA               
## RESPRACE_4CATO  0.065        
## optimizer (Nelder_Mead) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<p>The fit is possibly singular as we can see the small variance of the BMI slopes, plus the perfect correlation of slopes and intercepts.</p>
<p>The solution to the problem is often not clear. The most practical thing to do would be to revert back to the random-intercept model.</p>
</div>
<div id="level-2-predictors" class="section level3 hasAnchor" number="12.4.2">
<h3><span class="header-section-number">12.4.2</span> Level 2 predictors<a href="mlm-v.-gee-for-binary-outcomes.html#level-2-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In our reading, it was argued that GEE was better for these macro-micro situations, which is not necessarily true. Especially because in HLM, a level-2 variable can be entered wherever we like, and usually, it’s a predictor of the intercept. In that way, the effect is not on individuals, but on the mean. The odds ratio would then be that effect in a group with <span class="math inline">\(u_{0j} = 0\)</span> and again, we can investigate the variations in the effects as well as predictions</p>
<p>Let’s take a look at a county-based variable: is the ZIPREGION in Philadelphia County or not?</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="mlm-v.-gee-for-binary-outcomes.html#cb370-1" tabindex="-1"></a><span class="co"># collapse county into an indicator for Philadelphia County</span></span>
<span id="cb370-2"><a href="mlm-v.-gee-for-binary-outcomes.html#cb370-2" tabindex="-1"></a>PHMC18<span class="sc">$</span>PHILA <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(PHMC18<span class="sc">$</span>COUNTY <span class="sc">==</span> <span class="st">&quot;Philadelphia&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb370-3"><a href="mlm-v.-gee-for-binary-outcomes.html#cb370-3" tabindex="-1"></a>PHMC18<span class="sc">$</span>PHILA <span class="ot">&lt;-</span> <span class="fu">factor</span>(PHMC18<span class="sc">$</span>PHILA, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Not Phila&quot;</span>,<span class="st">&quot;Phila&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="mlm-v.-gee-for-binary-outcomes.html#cb371-1" tabindex="-1"></a>lvl2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(HOSPERA2 <span class="sc">~</span> SEX01 <span class="sc">+</span> RESPAGE_4CAT <span class="sc">+</span> cBMI <span class="sc">+</span> RESPRACE_4CAT <span class="sc">+</span> PHILA <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ZIPREGION), <span class="at">family =</span> binomial, <span class="at">data =</span> PHMC18)</span>
<span id="cb371-2"><a href="mlm-v.-gee-for-binary-outcomes.html#cb371-2" tabindex="-1"></a><span class="fu">summary</span>(lvl2)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
##  Family: binomial  ( logit )
## Formula: HOSPERA2 ~ SEX01 + RESPAGE_4CAT + cBMI + RESPRACE_4CAT + PHILA +      (1 | ZIPREGION)
##    Data: PHMC18
## 
##       AIC       BIC    logLik -2*log(L)  df.resid 
##      8304      8380     -4141      8282      7197 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -0.991 -0.610 -0.543  1.238  2.379 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  ZIPREGION (Intercept) 0.0292   0.171   
## Number of obs: 7208, groups:  ZIPREGION, 31
## 
## Fixed effects:
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)        -1.20372    0.10968  -10.98  &lt; 2e-16 ***
## SEX01Female         0.11744    0.05566    2.11    0.035 *  
## RESPAGE_4CAT35-49  -0.07713    0.11528   -0.67    0.503    
## RESPAGE_4CAT50-64  -0.09035    0.10394   -0.87    0.385    
## RESPAGE_4CAT65+     0.02482    0.10212    0.24    0.808    
## cBMI                0.01906    0.00442    4.31  1.6e-05 ***
## RESPRACE_4CATBlack  0.43717    0.08059    5.42  5.8e-08 ***
## RESPRACE_4CATAsian -0.30598    0.25326   -1.21    0.227    
## RESPRACE_4CATOther  0.43157    0.10763    4.01  6.1e-05 ***
## PHILAPhila          0.07661    0.08863    0.86    0.387    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                (Intr) SEX01F RESPAGE_4CAT3 RESPAGE_4CAT5 RESPAGE_4CAT6 cBMI   RESPRACE_4CATB
## SEX01Female    -0.253                                                                       
## RESPAGE_4CAT3  -0.678 -0.037                                                                
## RESPAGE_4CAT5  -0.768 -0.041  0.716                                                         
## RESPAGE_4CAT6  -0.784 -0.047  0.729         0.818                                           
## cBMI            0.049  0.024 -0.058        -0.086        -0.047                             
## RESPRACE_4CATB -0.071 -0.069  0.006         0.013         0.034        -0.092               
## RESPRACE_4CATA -0.119  0.032  0.055         0.085         0.103         0.015  0.084        
## RESPRACE_4CATO -0.169 -0.019  0.077         0.114         0.148        -0.031  0.277        
## PHILAPhila     -0.272 -0.026  0.016         0.037         0.021         0.021 -0.314        
##                RESPRACE_4CATA RESPRACE_4CATO
## SEX01Female                                 
## RESPAGE_4CAT3                               
## RESPAGE_4CAT5                               
## RESPAGE_4CAT6                               
## cBMI                                        
## RESPRACE_4CATB                              
## RESPRACE_4CATA                              
## RESPRACE_4CATO  0.068                       
## PHILAPhila     -0.038         -0.144</code></pre>
<p>Interestingly, the log-odds of an ED visit does not seem to differ between residents in and outside of Philadelphia County</p>
</div>
</div>
<div id="compare-to-gee" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> Compare to GEE<a href="mlm-v.-gee-for-binary-outcomes.html#compare-to-gee" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="mlm-v.-gee-for-binary-outcomes.html#cb373-1" tabindex="-1"></a>pop_avg2 <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(ed_visit <span class="sc">~</span> SEX01 <span class="sc">+</span> RESPAGE_4CAT <span class="sc">+</span> <span class="fu">scale</span>(BMI) <span class="sc">+</span> RESPRACE_4CAT <span class="sc">+</span> PHILA, <span class="at">id =</span> ZIPREGION, <span class="at">corstr =</span> <span class="st">&quot;exchangeable&quot;</span>, <span class="at">scale.fix =</span> <span class="cn">TRUE</span>, <span class="at">data =</span> PHMC18_gee, <span class="at">family=</span>binomial)</span>
<span id="cb373-2"><a href="mlm-v.-gee-for-binary-outcomes.html#cb373-2" tabindex="-1"></a></span>
<span id="cb373-3"><a href="mlm-v.-gee-for-binary-outcomes.html#cb373-3" tabindex="-1"></a><span class="fu">summary</span>(pop_avg2)</span></code></pre></div>
<pre><code>## 
## Call:
## geeglm(formula = ed_visit ~ SEX01 + RESPAGE_4CAT + scale(BMI) + 
##     RESPRACE_4CAT + PHILA, family = binomial, data = PHMC18_gee, 
##     id = ZIPREGION, corstr = &quot;exchangeable&quot;, scale.fix = TRUE)
## 
##  Coefficients:
##                    Estimate  Std.err   Wald Pr(&gt;|W|)    
## (Intercept)        -1.17527  0.09761 144.98  &lt; 2e-16 ***
## SEX01Female         0.12871  0.04169   9.53    0.002 ** 
## RESPAGE_4CAT35-49  -0.11005  0.10032   1.20    0.273    
## RESPAGE_4CAT50-64  -0.11870  0.09932   1.43    0.232    
## RESPAGE_4CAT65+    -0.00691  0.09211   0.01    0.940    
## scale(BMI)          0.13082  0.02543  26.47  2.7e-07 ***
## RESPRACE_4CATBlack  0.41433  0.06824  36.86  1.3e-09 ***
## RESPRACE_4CATAsian -0.25493  0.26134   0.95    0.329    
## RESPRACE_4CATOther  0.42189  0.09023  21.86  2.9e-06 ***
## PHILAPhila          0.07641  0.07914   0.93    0.334    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation structure = exchangeable 
## Scale is fixed.
## 
##   Link = identity 
## 
## Estimated Correlation Parameters:
##       Estimate Std.err
## alpha  0.00424 0.00222
## Number of clusters:   31  Maximum cluster size: 410</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="mlm-v.-gee-for-binary-outcomes.html#cb375-1" tabindex="-1"></a>lvl2.a <span class="ot">&lt;-</span> <span class="fu">glmer</span>(HOSPERA2 <span class="sc">~</span> SEX01 <span class="sc">+</span> RESPAGE_4CAT <span class="sc">+</span> cBMI <span class="sc">+</span> RESPRACE_4CAT <span class="sc">+</span> PHILA <span class="sc">+</span> PHILA<span class="sc">:</span>SEX01 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ZIPREGION), <span class="at">family =</span> binomial, <span class="at">data =</span> PHMC18)</span>
<span id="cb375-2"><a href="mlm-v.-gee-for-binary-outcomes.html#cb375-2" tabindex="-1"></a><span class="fu">summary</span>(lvl2.a)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
##  Family: binomial  ( logit )
## Formula: HOSPERA2 ~ SEX01 + RESPAGE_4CAT + cBMI + RESPRACE_4CAT + PHILA +  
##     PHILA:SEX01 + (1 | ZIPREGION)
##    Data: PHMC18
## 
##       AIC       BIC    logLik -2*log(L)  df.resid 
##      8306      8388     -4141      8282      7196 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -0.987 -0.612 -0.543  1.242  2.394 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  ZIPREGION (Intercept) 0.0292   0.171   
## Number of obs: 7208, groups:  ZIPREGION, 31
## 
## Fixed effects:
##                        Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)            -1.21741    0.11290  -10.78  &lt; 2e-16 ***
## SEX01Female             0.14091    0.07174    1.96     0.05 *  
## RESPAGE_4CAT35-49      -0.07768    0.11529   -0.67     0.50    
## RESPAGE_4CAT50-64      -0.09138    0.10396   -0.88     0.38    
## RESPAGE_4CAT65+         0.02503    0.10213    0.25     0.81    
## cBMI                    0.01913    0.00442    4.33  1.5e-05 ***
## RESPRACE_4CATBlack      0.43943    0.08070    5.45  5.2e-08 ***
## RESPRACE_4CATAsian     -0.30420    0.25330   -1.20     0.23    
## RESPRACE_4CATOther      0.43321    0.10768    4.02  5.7e-05 ***
## PHILAPhila              0.11263    0.11256    1.00     0.32    
## SEX01Female:PHILAPhila -0.05882    0.11331   -0.52     0.60    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                (Intr) SEX01Fm RESPAGE_4CAT3 RESPAGE_4CAT5 RESPAGE_4CAT6 cBMI   RESPRACE_4CATB
## SEX01Female    -0.340                                                                        
## RESPAGE_4CAT3  -0.657 -0.035                                                                 
## RESPAGE_4CAT5  -0.742 -0.043   0.716                                                         
## RESPAGE_4CAT6  -0.762 -0.034   0.729         0.818                                           
## cBMI            0.039  0.039  -0.058        -0.087        -0.047                             
## RESPRACE_4CATB -0.081 -0.020   0.005         0.012         0.034        -0.089               
## RESPRACE_4CATA -0.119  0.034   0.055         0.085         0.103         0.015  0.085        
## RESPRACE_4CATO -0.171  0.004   0.077         0.114         0.148        -0.029  0.278        
## PHILAPhila     -0.354  0.376   0.007         0.018         0.019         0.037 -0.213        
## SEX01F:PHIL     0.235 -0.631   0.009         0.018        -0.005        -0.033 -0.054        
##                RESPRACE_4CATA RESPRACE_4CATO PHILAP
## SEX01Female                                        
## RESPAGE_4CAT3                                      
## RESPAGE_4CAT5                                      
## RESPAGE_4CAT6                                      
## cBMI                                               
## RESPRACE_4CATB                                     
## RESPRACE_4CATA                                     
## RESPRACE_4CATO  0.069                              
## PHILAPhila     -0.021         -0.095               
## SEX01F:PHIL    -0.014         -0.029         -0.616</code></pre>
<div id="visualizing-res" class="section level3 hasAnchor" number="12.5.1">
<h3><span class="header-section-number">12.5.1</span> Visualizing REs<a href="mlm-v.-gee-for-binary-outcomes.html#visualizing-res" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, there are nice plot methods for visualizing the random effects themselves. This is easier with a smaller number of clusters, but it’s often nice.</p>
<p>Let’s first look at the unconditional variance of the intercepts:</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="mlm-v.-gee-for-binary-outcomes.html#cb377-1" tabindex="-1"></a>unc_mod <span class="ot">&lt;-</span> <span class="fu">glmer</span>(HOSPERA2 <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>ZIPREGION), <span class="at">family =</span> binomial, <span class="at">data =</span> PHMC18)</span>
<span id="cb377-2"><a href="mlm-v.-gee-for-binary-outcomes.html#cb377-2" tabindex="-1"></a><span class="fu">require</span>(lattice)</span>
<span id="cb377-3"><a href="mlm-v.-gee-for-binary-outcomes.html#cb377-3" tabindex="-1"></a><span class="fu">dotplot</span>(<span class="fu">ranef</span>(unc_mod))</span></code></pre></div>
<pre><code>## $ZIPREGION</code></pre>
<p><img src="_main_files/figure-html/mapit12-1.png" width="672" /></p>
<p>We can also look at conditional variance, and here, we’ll plot the slopes even though the model was singular. We do it in two separate plots because the estimated slope random effects are very small compared to the intercept random effects</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="mlm-v.-gee-for-binary-outcomes.html#cb379-1" tabindex="-1"></a>rand_slps <span class="ot">&lt;-</span> <span class="fu">ranef</span>(rand_sl)</span>
<span id="cb379-2"><a href="mlm-v.-gee-for-binary-outcomes.html#cb379-2" tabindex="-1"></a><span class="fu">dotplot</span>(rand_slps, <span class="at">scales =</span> <span class="fu">list</span>(<span class="at">relation =</span> <span class="st">&quot;free&quot;</span>))</span></code></pre></div>
<pre><code>## $ZIPREGION</code></pre>
<p><img src="_main_files/figure-html/mapit212-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multilevel-logistic-regression.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
