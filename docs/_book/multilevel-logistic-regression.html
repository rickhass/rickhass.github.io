<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Multilevel logistic regression | Generalized Linear Mixed Models with R: A tutorial</title>
  <meta name="description" content="11 Multilevel logistic regression | Generalized Linear Mixed Models with R: A tutorial" />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Multilevel logistic regression | Generalized Linear Mixed Models with R: A tutorial" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Multilevel logistic regression | Generalized Linear Mixed Models with R: A tutorial" />
  
  
  

<meta name="author" content="Rick Hass" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="longitudinal-models-with-upper-level-predictors.html"/>
<link rel="next" href="mlm-v.-gee-for-binary-outcomes.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="1" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>1</b> R Basics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="r-basics.html"><a href="r-basics.html#what-is-coding"><i class="fa fa-check"></i><b>1.1</b> What is “coding”</a></li>
<li class="chapter" data-level="1.2" data-path="r-basics.html"><a href="r-basics.html#r-console-versus-the-rstudio-script"><i class="fa fa-check"></i><b>1.2</b> R Console versus the RStudio Script</a></li>
<li class="chapter" data-level="1.3" data-path="r-basics.html"><a href="r-basics.html#working-with-data"><i class="fa fa-check"></i><b>1.3</b> Working with data</a></li>
<li class="chapter" data-level="1.4" data-path="r-basics.html"><a href="r-basics.html#using-a-script-to-generate-data-and-computing-the-mean-and-standard-deviation"><i class="fa fa-check"></i><b>1.4</b> Using a script to generate data, and computing the mean and standard deviation</a></li>
<li class="chapter" data-level="1.5" data-path="r-basics.html"><a href="r-basics.html#importing-data"><i class="fa fa-check"></i><b>1.5</b> Importing Data</a></li>
<li class="chapter" data-level="1.6" data-path="r-basics.html"><a href="r-basics.html#reading-in-an-spss-file"><i class="fa fa-check"></i><b>1.6</b> Reading in an SPSS file</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="r-basics.html"><a href="r-basics.html#a-quick-note-on-indexing"><i class="fa fa-check"></i><b>1.6.1</b> A quick note on indexing</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="r-basics.html"><a href="r-basics.html#frequencies-and-contingency-tables"><i class="fa fa-check"></i><b>1.7</b> Frequencies and Contingency Tables</a></li>
<li class="chapter" data-level="1.8" data-path="r-basics.html"><a href="r-basics.html#descriptive-statistics"><i class="fa fa-check"></i><b>1.8</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="r-basics.html"><a href="r-basics.html#the-describe-function"><i class="fa fa-check"></i><b>1.8.1</b> The describe function</a></li>
<li class="chapter" data-level="1.8.2" data-path="r-basics.html"><a href="r-basics.html#the-describeby-function"><i class="fa fa-check"></i><b>1.8.2</b> The describeBy function</a></li>
<li class="chapter" data-level="1.8.3" data-path="r-basics.html"><a href="r-basics.html#computing-a-new-variable-and-adding-it-to-the-dataframe"><i class="fa fa-check"></i><b>1.8.3</b> Computing a new variable and adding it to the dataframe</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="r-basics.html"><a href="r-basics.html#visualizing-data"><i class="fa fa-check"></i><b>1.9</b> Visualizing Data</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="r-basics.html"><a href="r-basics.html#histograms-and-density-plots"><i class="fa fa-check"></i><b>1.9.1</b> Histograms and density plots</a></li>
<li class="chapter" data-level="1.9.2" data-path="r-basics.html"><a href="r-basics.html#boxplots"><i class="fa fa-check"></i><b>1.9.2</b> Boxplots</a></li>
<li class="chapter" data-level="1.9.3" data-path="r-basics.html"><a href="r-basics.html#scatterplots"><i class="fa fa-check"></i><b>1.9.3</b> Scatterplots</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="r-basics.html"><a href="r-basics.html#review"><i class="fa fa-check"></i><b>1.10</b> Review</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html"><i class="fa fa-check"></i><b>2</b> Ordinary Linear Regression</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#our-data"><i class="fa fa-check"></i><b>2.1</b> Our data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#converting-from-numeric-to-factor"><i class="fa fa-check"></i><b>2.1.1</b> Converting from numeric to factor</a></li>
<li class="chapter" data-level="2.1.2" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#confidence-intervals-v.-p-values"><i class="fa fa-check"></i><b>2.1.2</b> Confidence Intervals v. p-values</a></li>
<li class="chapter" data-level="2.1.3" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#adding-interaction-terms"><i class="fa fa-check"></i><b>2.1.3</b> Adding interaction terms</a></li>
<li class="chapter" data-level="2.1.4" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#interaction-model-for-gambling"><i class="fa fa-check"></i><b>2.1.4</b> Interaction model for Gambling</a></li>
<li class="chapter" data-level="2.1.5" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#interaction-output"><i class="fa fa-check"></i><b>2.1.5</b> Interaction Output</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#anova-and-drop1-commands"><i class="fa fa-check"></i><b>2.2</b> ANOVA and drop1 commands</a></li>
<li class="chapter" data-level="2.3" data-path="ordinary-linear-regression.html"><a href="ordinary-linear-regression.html#plots"><i class="fa fa-check"></i><b>2.3</b> Plots</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>3</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#an-example-diabetes-risk-factors"><i class="fa fa-check"></i><b>3.1</b> An Example: Diabetes risk factors</a></li>
<li class="chapter" data-level="3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#model-discrimination-and-fit"><i class="fa fa-check"></i><b>3.2</b> Model Discrimination and Fit</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="logistic-regression.html"><a href="logistic-regression.html#roc-and-auroc"><i class="fa fa-check"></i><b>3.2.1</b> ROC and AUROC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regression-with-counts-as-outcomes.html"><a href="regression-with-counts-as-outcomes.html"><i class="fa fa-check"></i><b>4</b> Regression with Counts as Outcomes</a>
<ul>
<li class="chapter" data-level="4.1" data-path="regression-with-counts-as-outcomes.html"><a href="regression-with-counts-as-outcomes.html#example-data-phmc-fruits-question"><i class="fa fa-check"></i><b>4.1</b> Example data: PHMC Fruits question</a></li>
<li class="chapter" data-level="4.2" data-path="regression-with-counts-as-outcomes.html"><a href="regression-with-counts-as-outcomes.html#coefficients-in-poisson-models"><i class="fa fa-check"></i><b>4.2</b> Coefficients in Poisson Models</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="regression-with-counts-as-outcomes.html"><a href="regression-with-counts-as-outcomes.html#exponentiated-coefficients-interpretation"><i class="fa fa-check"></i><b>4.2.1</b> Exponentiated Coefficients Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="regression-with-counts-as-outcomes.html"><a href="regression-with-counts-as-outcomes.html#overdispersion-and-other-count-regression-models"><i class="fa fa-check"></i><b>4.3</b> Overdispersion and other count regression models</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="regression-with-counts-as-outcomes.html"><a href="regression-with-counts-as-outcomes.html#overdispersion-and-zero-inflation"><i class="fa fa-check"></i><b>4.3.1</b> Overdispersion and Zero-inflation</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="regression-with-counts-as-outcomes.html"><a href="regression-with-counts-as-outcomes.html#zero-inflated-models"><i class="fa fa-check"></i><b>4.4</b> Zero-inflated models</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html"><i class="fa fa-check"></i><b>5</b> Model Fit and Assumptions for GLMs</a>
<ul>
<li class="chapter" data-level="5.1" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#model-checking-and-diagnostics-in-ordinary-least-squares"><i class="fa fa-check"></i><b>5.1</b> Model Checking and Diagnostics in Ordinary Least Squares</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#residuals-v.-fitted-values"><i class="fa fa-check"></i><b>5.1.1</b> Residuals v. Fitted Values</a></li>
<li class="chapter" data-level="5.1.2" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#normalty-of-residuals"><i class="fa fa-check"></i><b>5.1.2</b> Normalty of residuals</a></li>
<li class="chapter" data-level="5.1.3" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#leverage"><i class="fa fa-check"></i><b>5.1.3</b> Leverage</a></li>
<li class="chapter" data-level="5.1.4" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#influence"><i class="fa fa-check"></i><b>5.1.4</b> Influence</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#model-checking-and-diagnostics-in-logistic-regression"><i class="fa fa-check"></i><b>5.2</b> Model Checking and Diagnostics in Logistic Regression</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#hosmer-lemeshow-test"><i class="fa fa-check"></i><b>5.2.1</b> Hosmer-Lemeshow Test</a></li>
<li class="chapter" data-level="5.2.2" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#nagelkerkes-pseudo-r-squared"><i class="fa fa-check"></i><b>5.2.2</b> Nagelkerke’s pseudo R-squared</a></li>
<li class="chapter" data-level="5.2.3" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#residuals-and-leverages"><i class="fa fa-check"></i><b>5.2.3</b> Residuals and leverages</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="model-fit-and-assumptions-for-glms.html"><a href="model-fit-and-assumptions-for-glms.html#summary"><i class="fa fa-check"></i><b>5.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html"><i class="fa fa-check"></i><b>6</b> Introducing mixed-models and the lme4 package</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#options-in-r"><i class="fa fa-check"></i><b>6.1</b> Options in R</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#why-lme4"><i class="fa fa-check"></i><b>6.1.1</b> Why lme4?</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#a-possible-workflow"><i class="fa fa-check"></i><b>6.2</b> A possible workflow</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#high-school-and-beyond"><i class="fa fa-check"></i><b>6.2.1</b> High School and Beyond</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#model-1-one-way-random-effects-anova-using-reml"><i class="fa fa-check"></i><b>6.3</b> Model 1: one-way random-effects ANOVA using REML</a></li>
<li class="chapter" data-level="6.4" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#quasi-anova-estimator"><i class="fa fa-check"></i><b>6.4</b> Quasi-ANOVA estimator</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#unrestricted-maximum-likelihood"><i class="fa fa-check"></i><b>6.4.1</b> (unrestricted) Maximum Likelihood</a></li>
<li class="chapter" data-level="6.4.2" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#intraclass-correlation"><i class="fa fa-check"></i><b>6.4.2</b> Intraclass correlation</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#bootstrapped-confidence-intervals"><i class="fa fa-check"></i><b>6.5</b> Bootstrapped confidence intervals</a></li>
<li class="chapter" data-level="6.6" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#linear-mixed-effects"><i class="fa fa-check"></i><b>6.6</b> Linear mixed-effects</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="introducing-mixed-models-and-the-lme4-package.html"><a href="introducing-mixed-models-and-the-lme4-package.html#random-effects-estimates"><i class="fa fa-check"></i><b>6.6.1</b> Random effects estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html"><i class="fa fa-check"></i><b>7</b> Mixed models as Hierarchical Linear Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html#high-school-and-beyond-data"><i class="fa fa-check"></i><b>7.1</b> High School and Beyond Data</a></li>
<li class="chapter" data-level="7.2" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html#model-1-unconditional-model"><i class="fa fa-check"></i><b>7.2</b> Model 1: unconditional model</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html#unconditional-icc"><i class="fa fa-check"></i><b>7.2.1</b> Unconditional ICC</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html#means-as-outcomes-binary-predictor"><i class="fa fa-check"></i><b>7.3</b> Means as outcomes: Binary Predictor</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html#means-as-outcomes-continuous-predictor"><i class="fa fa-check"></i><b>7.3.1</b> Means as outcomes: continuous predictor</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html#multiple-hierarchical-linear-regression"><i class="fa fa-check"></i><b>7.4</b> Multiple hierarchical linear regression</a></li>
<li class="chapter" data-level="7.5" data-path="mixed-models-as-hierarchical-linear-models.html"><a href="mixed-models-as-hierarchical-linear-models.html#plotting-predictor-effects"><i class="fa fa-check"></i><b>7.5</b> Plotting predictor effects</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html"><i class="fa fa-check"></i><b>8</b> More on Hierarchical Linear Models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#overview-1"><i class="fa fa-check"></i><b>8.1</b> Overview</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#load-the-data"><i class="fa fa-check"></i><b>8.1.1</b> Load the data</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#random-coefficients-model"><i class="fa fa-check"></i><b>8.2</b> Random Coefficients model</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#visualizing-the-within-school-slopes"><i class="fa fa-check"></i><b>8.2.1</b> Visualizing the within-school slopes</a></li>
<li class="chapter" data-level="8.2.2" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#fitting-the-random-coefficients-2-level-model"><i class="fa fa-check"></i><b>8.2.2</b> Fitting the Random Coefficients 2-level model</a></li>
<li class="chapter" data-level="8.2.3" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#adding-additional-level-1-predictors-to-the-random-coefficients-model"><i class="fa fa-check"></i><b>8.2.3</b> Adding additional level-1 predictors to the random coefficients model</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#intercepts-and-slopes-as-outcomes"><i class="fa fa-check"></i><b>8.3</b> Intercepts and Slopes as Outcomes</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#interactions-and-the-iso-model"><i class="fa fa-check"></i><b>8.3.1</b> Interactions and the ISO model</a></li>
<li class="chapter" data-level="8.3.2" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#mean-ses-and-student-ses"><i class="fa fa-check"></i><b>8.3.2</b> Mean SES and Student SES</a></li>
<li class="chapter" data-level="8.3.3" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#sector-and-student-ses"><i class="fa fa-check"></i><b>8.3.3</b> Sector and Student SES</a></li>
<li class="chapter" data-level="8.3.4" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#visualizing-the-mean-ses-effect"><i class="fa fa-check"></i><b>8.3.4</b> Visualizing the mean SES effect</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#model-comparison-with-likelihood-ratios-fixed-and-random"><i class="fa fa-check"></i><b>8.4</b> Model comparison with Likelihood Ratios: Fixed and Random</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#example-1-lrt-for-fixed-effects"><i class="fa fa-check"></i><b>8.4.1</b> Example 1: LRT for fixed effects</a></li>
<li class="chapter" data-level="8.4.2" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#example-2-lrt-for-random-effects"><i class="fa fa-check"></i><b>8.4.2</b> Example 2: LRT for random effects</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="more-on-hierarchical-linear-models.html"><a href="more-on-hierarchical-linear-models.html#diagnostics"><i class="fa fa-check"></i><b>8.5</b> Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html"><i class="fa fa-check"></i><b>9</b> Using lme4 to fit MLM to longitudinal data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#data-description-average-reaction-time-per-day-for-subjects-in-a-sleep-deprivation-study-belenky-et-al.-2003"><i class="fa fa-check"></i><b>9.1</b> Data description: average reaction time per day for subjects in a sleep deprivation study (Belenky et al. 2003)</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#visualization-of-the-data"><i class="fa fa-check"></i><b>9.1.1</b> Visualization of the data</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#fitting-the-level-1-model"><i class="fa fa-check"></i><b>9.2</b> Fitting the level-1 model</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#model-equations"><i class="fa fa-check"></i><b>9.2.1</b> Model Equations</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#model-building"><i class="fa fa-check"></i><b>9.3</b> Model building</a></li>
<li class="chapter" data-level="9.4" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#model-comparison-and-testing"><i class="fa fa-check"></i><b>9.4</b> Model comparison and testing</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#option-1-using-confidence-intervals"><i class="fa fa-check"></i><b>9.4.1</b> Option 1: using confidence intervals</a></li>
<li class="chapter" data-level="9.4.2" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#tests"><i class="fa fa-check"></i><b>9.4.2</b> Tests</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#quadratic-model-with-lmer"><i class="fa fa-check"></i><b>9.5</b> Quadratic model with lmer</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#a-note-on-quadratic-terms"><i class="fa fa-check"></i><b>9.5.1</b> A note on quadratic terms</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#summary-of-the-sleepstudy-analysis"><i class="fa fa-check"></i><b>9.6</b> Summary of the sleepstudy analysis</a></li>
<li class="chapter" data-level="9.7" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#preview-of-the-blackmore-data-used-for-assignment-7b"><i class="fa fa-check"></i><b>9.7</b> Preview of the Blackmore data used for Assignment 7b</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="using-lme4-to-fit-mlm-to-longitudinal-data.html"><a href="using-lme4-to-fit-mlm-to-longitudinal-data.html#a-note-on-the-age-variable-in-blackmore"><i class="fa fa-check"></i><b>9.7.1</b> A note on the age variable in Blackmore</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html"><i class="fa fa-check"></i><b>10</b> Longitudinal models with upper-level predictors</a>
<ul>
<li class="chapter" data-level="10.1" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#overview-2"><i class="fa fa-check"></i><b>10.1</b> Overview</a></li>
<li class="chapter" data-level="10.2" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#part-1-intercepts-and-slopes-as-outcomes"><i class="fa fa-check"></i><b>10.2</b> Part 1: Intercepts and Slopes as Outcomes</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#a-short-tutorial-on-ggplot2"><i class="fa fa-check"></i><b>10.2.1</b> A short tutorial on ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#adding-level-2-predictors"><i class="fa fa-check"></i><b>10.3</b> Adding level 2 predictors</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#transforming-the-exercise-variable"><i class="fa fa-check"></i><b>10.3.1</b> Transforming the Exercise Variable</a></li>
<li class="chapter" data-level="10.3.2" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#steps-1-and-2"><i class="fa fa-check"></i><b>10.3.2</b> Steps 1 and 2:</a></li>
<li class="chapter" data-level="10.3.3" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#step-3"><i class="fa fa-check"></i><b>10.3.3</b> Step 3:</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#summary-1"><i class="fa fa-check"></i><b>10.4</b> Summary</a></li>
<li class="chapter" data-level="10.5" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#adding-level-2-explanatory-variables"><i class="fa fa-check"></i><b>10.5</b> Adding Level-2 Explanatory variables</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#visualizing-the-transformed-data"><i class="fa fa-check"></i><b>10.5.1</b> Visualizing the transformed data</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#time-dependent-covariates"><i class="fa fa-check"></i><b>10.6</b> Time dependent covariates</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#level-1-time-dependent-sports-predictor"><i class="fa fa-check"></i><b>10.6.1</b> Level-1: Time-dependent sports predictor</a></li>
<li class="chapter" data-level="10.6.2" data-path="longitudinal-models-with-upper-level-predictors.html"><a href="longitudinal-models-with-upper-level-predictors.html#level-2-participant-level-indicator-of-sports-participation"><i class="fa fa-check"></i><b>10.6.2</b> Level-2: Participant-level indicator of sports participation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="multilevel-logistic-regression.html"><a href="multilevel-logistic-regression.html"><i class="fa fa-check"></i><b>11</b> Multilevel logistic regression</a>
<ul>
<li class="chapter" data-level="11.1" data-path="multilevel-logistic-regression.html"><a href="multilevel-logistic-regression.html#unconditional-model"><i class="fa fa-check"></i><b>11.1</b> Unconditional model</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="multilevel-logistic-regression.html"><a href="multilevel-logistic-regression.html#fitting-the-model"><i class="fa fa-check"></i><b>11.1.1</b> Fitting the model</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="multilevel-logistic-regression.html"><a href="multilevel-logistic-regression.html#conditional-model"><i class="fa fa-check"></i><b>11.2</b> Conditional model</a></li>
<li class="chapter" data-level="11.3" data-path="multilevel-logistic-regression.html"><a href="multilevel-logistic-regression.html#interpreting-odds-ratios"><i class="fa fa-check"></i><b>11.3</b> Interpreting odds ratios</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html"><i class="fa fa-check"></i><b>12</b> MLM v. GEE for Binary Outcomes</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#overview-3"><i class="fa fa-check"></i><b>12.1</b> Overview</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#dataset"><i class="fa fa-check"></i><b>12.1.1</b> Dataset</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#hlm-model"><i class="fa fa-check"></i><b>12.2</b> HLM Model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#interpreting-odds-ratios-1"><i class="fa fa-check"></i><b>12.2.1</b> Interpreting odds ratios</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#population-average-model-with-gee"><i class="fa fa-check"></i><b>12.3</b> Population Average Model with GEE</a></li>
<li class="chapter" data-level="12.4" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#hlm-with-level-2-predictors"><i class="fa fa-check"></i><b>12.4</b> HLM with level-2 predictors</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#random-slopes-1"><i class="fa fa-check"></i><b>12.4.1</b> Random slopes</a></li>
<li class="chapter" data-level="12.4.2" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#level-2-predictors"><i class="fa fa-check"></i><b>12.4.2</b> Level 2 predictors</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#compare-to-gee"><i class="fa fa-check"></i><b>12.5</b> Compare to GEE</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="mlm-v.-gee-for-binary-outcomes.html"><a href="mlm-v.-gee-for-binary-outcomes.html#visualizing-res"><i class="fa fa-check"></i><b>12.5.1</b> Visualizing REs</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Generalized Linear Mixed Models with R: A tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multilevel-logistic-regression" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">11</span> Multilevel logistic regression<a href="multilevel-logistic-regression.html#multilevel-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Overview</p>
<ul>
<li>Explore how to deal with binary outcomes in multilevel framework</li>
<li>Simple random-effects models for binary outcomes</li>
</ul>
<p>Dataset</p>
<p>For illustration, we’ll use the <strong>2018 PHMC Survey Dataset</strong></p>
<ul>
<li>Note: this is a different data set than you’ll use in your project</li>
</ul>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="multilevel-logistic-regression.html#cb336-1" tabindex="-1"></a>PHMC18 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="fu">url</span>(<span class="st">&quot;https://rickhass.github.io/PHMC18_Data.rds&quot;</span>))</span></code></pre></div>
<p>Though a more fine-grained analysis can be had by exploring effects by Zip Code, the dataset also has a <code>ZIPREGION</code> variable has 31 levels (see p. )</p>
<blockquote>
<p>Based on City Planning Commission Planning Analysis Sections. For Bucks, Chester, Delaware, and Montgomery counties the ZIPREGION categories were developed to provide geographic areas with sufficient sample size for most statistical calculations.</p>
</blockquote>
<p>Twelve of them are in Philadelphia County, and the rest are North, Central, Central-South, etc. for Bucks, Chester, Delaware, and Montgomery counties</p>
<p>Let’s look at incidence of emergency department visits in the last year reported by respondents across these 31 regions:</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="multilevel-logistic-regression.html#cb337-1" tabindex="-1"></a><span class="co"># table of Hospitalization by ZIPREGION</span></span>
<span id="cb337-2"><a href="multilevel-logistic-regression.html#cb337-2" tabindex="-1"></a>hosp.by.z <span class="ot">&lt;-</span> <span class="fu">table</span>(PHMC18<span class="sc">$</span>HOSPERA2, <span class="at">by =</span> PHMC18<span class="sc">$</span>ZIPREGION)</span>
<span id="cb337-3"><a href="multilevel-logistic-regression.html#cb337-3" tabindex="-1"></a></span>
<span id="cb337-4"><a href="multilevel-logistic-regression.html#cb337-4" tabindex="-1"></a><span class="co"># Chi-squared test</span></span>
<span id="cb337-5"><a href="multilevel-logistic-regression.html#cb337-5" tabindex="-1"></a>(chi2 <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(hosp.by.z))</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  hosp.by.z
## X-squared = 130.49, df = 30, p-value = 1.699e-14</code></pre>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="multilevel-logistic-regression.html#cb339-1" tabindex="-1"></a><span class="co"># Average Incidence of hosp</span></span>
<span id="cb339-2"><a href="multilevel-logistic-regression.html#cb339-2" tabindex="-1"></a><span class="fu">sum</span>(hosp.by.z[<span class="dv">2</span>,])<span class="sc">/</span><span class="fu">sum</span>(hosp.by.z)</span></code></pre></div>
<pre><code>## [1] 0.2719334</code></pre>
<p>The <span class="math inline">\(\chi^{2}\)</span> test is extremely high powered, so not surprising that we find evidence that <span class="math inline">\(\hat{p}\)</span> varies by <code>ZIPREGION</code>.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="multilevel-logistic-regression.html#cb341-1" tabindex="-1"></a>props <span class="ot">&lt;-</span> hosp.by.z[<span class="dv">2</span>,]<span class="sc">/</span>(hosp.by.z[<span class="dv">2</span>,] <span class="sc">+</span> hosp.by.z[<span class="dv">1</span>,])</span>
<span id="cb341-2"><a href="multilevel-logistic-regression.html#cb341-2" tabindex="-1"></a></span>
<span id="cb341-3"><a href="multilevel-logistic-regression.html#cb341-3" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">densityplot</span>(props, <span class="at">xlab =</span> <span class="st">&quot;Proportion of Hospitalized Respondents per zipcode region&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/props_zip11-1.png" width="672" /></p>
<p>We can, in fact, see that there is variability in the proportion of respondents reporting an ED visit in the last year across the regions. The density is relatively symmetrical.</p>
<ul>
<li>Note, this variable is actually a dichotomized version of a variable asking for how many times a person visited the ED, but not surprisingly, it’s relatively rare to visit the ED more than once in a year</li>
</ul>
<div id="unconditional-model" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Unconditional model<a href="multilevel-logistic-regression.html#unconditional-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, let’s get a model-based estimate of the between-cluster variability in proportions. Again, we do this by converting to the logit model</p>
<p>Level 1:
<span class="math display">\[
\text{logit}(P(Y_{ij} = 1)) = \beta_{0j}
\]</span></p>
<p>Level 2:
<span class="math display">\[
\beta_{0j} = \gamma_{00} + u_{0j}
\]</span></p>
<p>Again, note that the usual <span class="math inline">\(r_{ij}\)</span> is not explicitly in level 1. It is dealt with in the estimation process.</p>
<p>In words: the log-odds of an ED visit is simply a function of the overall log-odds plus some effect of living in zip region <span class="math inline">\(j\)</span></p>
<div id="fitting-the-model" class="section level3 hasAnchor" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> Fitting the model<a href="multilevel-logistic-regression.html#fitting-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will use the <code>glmer</code> function in the <code>lme4</code> package, which is an extension of the <code>glm</code> function in the same way <code>lmer</code> is an extension of the <code>lm</code> function. The syntax is the same, and we add the <code>family = binomial</code> argument to obtain the correct model and link function (logit)</p>
<p>Important points:</p>
<ol style="list-style-type: decimal">
<li>There is no <code>REML = FALSE</code> or <code>REML = TRUE</code>, estimation is done using full maximum likelihood via either Laplace Approximation or Gaussian Quadrature (more on this next week)</li>
<li>We will only get variance estimation for the random effects at levels 2 and up</li>
<li>We are given <span class="math inline">\(p\)</span>-values based on Wald Tests, but they are not always accruate (more on this next week too)</li>
</ol>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="multilevel-logistic-regression.html#cb342-1" tabindex="-1"></a>unc_mod <span class="ot">&lt;-</span> <span class="fu">glmer</span>(HOSPERA2 <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>ZIPREGION), <span class="at">family =</span> binomial, <span class="at">data =</span> PHMC18)</span>
<span id="cb342-2"><a href="multilevel-logistic-regression.html#cb342-2" tabindex="-1"></a><span class="fu">summary</span>(unc_mod)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
##  Family: binomial  ( logit )
## Formula: HOSPERA2 ~ (1 | ZIPREGION)
##    Data: PHMC18
## 
##       AIC       BIC    logLik -2*log(L)  df.resid 
##    8528.1    8541.9   -4262.1    8524.1      7327 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -0.8063 -0.6325 -0.5671  1.3607  2.0375 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  ZIPREGION (Intercept) 0.07431  0.2726  
## Number of obs: 7329, groups:  ZIPREGION, 31
## 
## Fixed effects:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.02211    0.05684  -17.98   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Main results:</p>
<ul>
<li><span class="math inline">\(\gamma_{00} = -1.02\)</span> so the model-estimated mean logit of ED visits is <span class="math inline">\(-1.02\)</span></li>
</ul>
<p>To make this a probability we use the inverse link function:</p>
<p><span class="math display">\[
\begin{aligned}
h(\eta) &amp; = \frac{e^{(\eta)}}{1 + e^{(\eta)}}\\
        &amp; = \frac{e^{-1.02}}{1 + e^{-1.02}}\\
        &amp; = \frac{0.361}{1 + 0.361}\\
        &amp; = 0.265
\end{aligned}
\]</span>
Contrast that with the population estimate <span class="math inline">\(\hat{p} = 0.272\)</span> above. Here, the <em>model-based</em> estimate is cluster specific. So in the “typical” cluster, or one with a random effect of zero, we expect an ED visit with <span class="math inline">\(p = 0.265\)</span></p>
<ul>
<li><span class="math inline">\(\text{Var}(\beta_{0j}) = \tau_{00} = 0.07\)</span> or <span class="math inline">\(SD = \sqrt{\tau} = 0.273\)</span></li>
</ul>
<p>The model-based distribution is shown below, with a rug-plot showing the observed log-odds across the 31 zipcode regions</p>
<ul>
<li>The code is based on Snijders and Bosker, and can be obtained at their <a href="https://www.stats.ox.ac.uk/~snijders/mlbook.htm">website</a></li>
</ul>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="multilevel-logistic-regression.html#cb344-1" tabindex="-1"></a><span class="co"># Estimated average log-odds is</span></span>
<span id="cb344-2"><a href="multilevel-logistic-regression.html#cb344-2" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">fixef</span>(unc_mod)</span>
<span id="cb344-3"><a href="multilevel-logistic-regression.html#cb344-3" tabindex="-1"></a><span class="co"># which transformed to a probability is</span></span>
<span id="cb344-4"><a href="multilevel-logistic-regression.html#cb344-4" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">exp</span>(b0)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(b0))</span>
<span id="cb344-5"><a href="multilevel-logistic-regression.html#cb344-5" tabindex="-1"></a><span class="co"># The estimated level-2 variance is</span></span>
<span id="cb344-6"><a href="multilevel-logistic-regression.html#cb344-6" tabindex="-1"></a>tau00 <span class="ot">&lt;-</span> (<span class="fu">VarCorr</span>(unc_mod)<span class="sc">$</span>ZIPREGION[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb344-7"><a href="multilevel-logistic-regression.html#cb344-7" tabindex="-1"></a><span class="co"># with corresponding standard deviation</span></span>
<span id="cb344-8"><a href="multilevel-logistic-regression.html#cb344-8" tabindex="-1"></a>tau0 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(tau00)</span>
<span id="cb344-9"><a href="multilevel-logistic-regression.html#cb344-9" tabindex="-1"></a><span class="co"># Approximation formula (17.13) yields</span></span>
<span id="cb344-10"><a href="multilevel-logistic-regression.html#cb344-10" tabindex="-1"></a>var0 <span class="ot">&lt;-</span> tau00<span class="sc">*</span>((p0<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p0))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb344-11"><a href="multilevel-logistic-regression.html#cb344-11" tabindex="-1"></a></span>
<span id="cb344-12"><a href="multilevel-logistic-regression.html#cb344-12" tabindex="-1"></a><span class="do">## observed log odds</span></span>
<span id="cb344-13"><a href="multilevel-logistic-regression.html#cb344-13" tabindex="-1"></a>logodds <span class="ot">&lt;-</span> <span class="fu">log</span>(props<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>props))</span>
<span id="cb344-14"><a href="multilevel-logistic-regression.html#cb344-14" tabindex="-1"></a></span>
<span id="cb344-15"><a href="multilevel-logistic-regression.html#cb344-15" tabindex="-1"></a><span class="co"># The normal density in Figure 17.5 can be obtained by</span></span>
<span id="cb344-16"><a href="multilevel-logistic-regression.html#cb344-16" tabindex="-1"></a>x <span class="ot">&lt;-</span> tau0<span class="sc">*</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span><span class="sc">:</span><span class="dv">100</span>)<span class="sc">/</span><span class="dv">25</span><span class="sc">+</span>b0</span>
<span id="cb344-17"><a href="multilevel-logistic-regression.html#cb344-17" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x,<span class="at">mean=</span>b0,<span class="at">sd=</span>tau0)</span>
<span id="cb344-18"><a href="multilevel-logistic-regression.html#cb344-18" tabindex="-1"></a><span class="fu">plot</span>(x,y, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;log-odds of ED visit&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;density&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Observed and model-based distribution of</span><span class="sc">\n</span><span class="st">log-odds of ED visits across zip regions&quot;</span>)</span>
<span id="cb344-19"><a href="multilevel-logistic-regression.html#cb344-19" tabindex="-1"></a><span class="fu">rug</span>(logodds)</span></code></pre></div>
<p><img src="_main_files/figure-html/logodds11-1.png" width="672" /></p>
</div>
</div>
<div id="conditional-model" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Conditional model<a href="multilevel-logistic-regression.html#conditional-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now let’s add some predictors at level 1. You’ll find that things will get complex very quickly in terms of running time of the fitting process. There are mathematical reasons for this involving the approximation of the likelihood function, which must be marginalized over the random-effects. If it sounds daunting, it is!</p>
<p>There are obviously numerous explanatory factors for an ED visit, and our model won’t be complete, but will suffice to illustrate how to add level-1 predictors.</p>
<p>Predictors:</p>
<ol style="list-style-type: decimal">
<li>SEX01 (Male / Female)</li>
<li>RESPAGE_4CAT - 4 category age variable</li>
<li>BMI</li>
<li>RESPRACE_4CAT - White, Black, Asian, Other</li>
<li>NPOV100 - indicator for poverty</li>
</ol>
<p>Stay tuned for quite a bit of output!</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="multilevel-logistic-regression.html#cb345-1" tabindex="-1"></a>cond_mod <span class="ot">&lt;-</span> <span class="fu">glmer</span>(HOSPERA2 <span class="sc">~</span> SEX01 <span class="sc">+</span> RESPAGE_4CAT <span class="sc">+</span> <span class="fu">scale</span>(BMI) <span class="sc">+</span> RESPRACE_4CAT <span class="sc">+</span> NPOV100 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ZIPREGION), <span class="at">family =</span> binomial, <span class="at">data =</span> PHMC18)</span>
<span id="cb345-2"><a href="multilevel-logistic-regression.html#cb345-2" tabindex="-1"></a><span class="fu">summary</span>(cond_mod)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
##  Family: binomial  ( logit )
## Formula: HOSPERA2 ~ SEX01 + RESPAGE_4CAT + scale(BMI) + RESPRACE_4CAT +      NPOV100 + (1 | ZIPREGION)
##    Data: PHMC18
## 
##       AIC       BIC    logLik -2*log(L)  df.resid 
##    7917.5    7992.8   -3947.8    7895.5      6916 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.1945 -0.6003 -0.5322  1.1341  2.4108 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  ZIPREGION (Intercept) 0.01818  0.1348  
## Number of obs: 6927, groups:  ZIPREGION, 31
## 
## Fixed effects:
##                        Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)           -0.645074   0.126977  -5.080 3.77e-07 ***
## SEX01Female            0.109431   0.056905   1.923 0.054474 .  
## RESPAGE_4CAT35-49     -0.094279   0.117951  -0.799 0.424113    
## RESPAGE_4CAT50-64     -0.117714   0.105760  -1.113 0.265698    
## RESPAGE_4CAT65+       -0.009925   0.103941  -0.095 0.923927    
## scale(BMI)             0.122698   0.027196   4.512 6.43e-06 ***
## RESPRACE_4CATBlack     0.385136   0.076132   5.059 4.22e-07 ***
## RESPRACE_4CATAsian    -0.303373   0.261972  -1.158 0.246849    
## RESPRACE_4CATOther     0.370979   0.109083   3.401 0.000672 ***
## NPOV100Not in poverty -0.562270   0.078256  -7.185 6.72e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                (Intr) SEX01F RESPAGE_4CAT3 RESPAGE_4CAT5 RESPAGE_4CAT6 s(BMI) RESPRACE_4CATB
## SEX01Female    -0.259                                                                       
## RESPAGE_4CAT3  -0.579 -0.033                                                                
## RESPAGE_4CAT5  -0.665 -0.032  0.711                                                         
## RESPAGE_4CAT6  -0.685 -0.044  0.724         0.816                                           
## scale(BMI)      0.028  0.018 -0.061        -0.087        -0.045                             
## RESPRACE_4CATB -0.201 -0.083  0.015         0.030         0.047        -0.098               
## RESPRACE_4CATA -0.126  0.030  0.048         0.081         0.098         0.018  0.074        
## RESPRACE_4CATO -0.228 -0.020  0.077         0.117         0.150        -0.029  0.238        
## NPOV100Ntip    -0.557  0.054 -0.021        -0.006         0.002         0.040  0.104        
##                RESPRACE_4CATA RESPRACE_4CATO
## SEX01Female                                 
## RESPAGE_4CAT3                               
## RESPAGE_4CAT5                               
## RESPAGE_4CAT6                               
## scale(BMI)                                  
## RESPRACE_4CATB                              
## RESPRACE_4CATA                              
## RESPRACE_4CATO  0.063                       
## NPOV100Ntip     0.034          0.087</code></pre>
<p>Some things of note:</p>
<ol style="list-style-type: decimal">
<li>BMI is a numeric variable, which should be cluster-centered. Here, I quickly used grand-mean centering via the <code>scale()</code> function, which turns BMI into mean-deviation form</li>
<li>Even though we have not included any ZIPREGION level variables, the residual variance of the random effects has dropped to <span class="math inline">\(\tau_{00} = 0.018\)</span></li>
<li>There seems to be no evidence for age-related differences in log-odds between the youngest respondents and the 3 oldest</li>
<li>The other effects are as we might expect</li>
</ol>
<p>Also, the Laplace approximation can be improved upon, and we’ll demonstrate now with Gaussian Quadrature. Note my call to <code>system.time</code></p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="multilevel-logistic-regression.html#cb347-1" tabindex="-1"></a><span class="fu">system.time</span>(cond_modq <span class="ot">&lt;-</span> <span class="fu">glmer</span>(HOSPERA2 <span class="sc">~</span> SEX01 <span class="sc">+</span> RESPAGE_4CAT <span class="sc">+</span> <span class="fu">scale</span>(BMI) <span class="sc">+</span> RESPRACE_4CAT <span class="sc">+</span> NPOV100 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ZIPREGION), <span class="at">family =</span> binomial, <span class="at">data =</span> PHMC18, <span class="at">nAGQ =</span> <span class="dv">10</span>))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   2.727   0.037   2.764</code></pre>
<p>Below we see that the fixed effects are identical and the random effect variances differ only at the thousandths place:</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="multilevel-logistic-regression.html#cb349-1" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="st">&quot;Laplace&quot;</span><span class="ot">=</span> <span class="fu">round</span>(<span class="fu">fixef</span>(cond_mod), <span class="dv">3</span>), <span class="st">&quot;AQ&quot;</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">fixef</span>(cond_modq), <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##                       Laplace     AQ
## (Intercept)            -0.645 -0.645
## SEX01Female             0.109  0.109
## RESPAGE_4CAT35-49      -0.094 -0.094
## RESPAGE_4CAT50-64      -0.118 -0.118
## RESPAGE_4CAT65+        -0.010 -0.010
## scale(BMI)              0.123  0.123
## RESPRACE_4CATBlack      0.385  0.385
## RESPRACE_4CATAsian     -0.303 -0.303
## RESPRACE_4CATOther      0.371  0.371
## NPOV100Not in poverty  -0.562 -0.562</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="multilevel-logistic-regression.html#cb351-1" tabindex="-1"></a><span class="co"># SD from Laplace</span></span>
<span id="cb351-2"><a href="multilevel-logistic-regression.html#cb351-2" tabindex="-1"></a><span class="fu">VarCorr</span>(cond_mod)</span></code></pre></div>
<pre><code>##  Groups    Name        Std.Dev.
##  ZIPREGION (Intercept) 0.13484</code></pre>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="multilevel-logistic-regression.html#cb353-1" tabindex="-1"></a><span class="co"># SD from Quadrature</span></span>
<span id="cb353-2"><a href="multilevel-logistic-regression.html#cb353-2" tabindex="-1"></a><span class="fu">VarCorr</span>(cond_modq)</span></code></pre></div>
<pre><code>##  Groups    Name        Std.Dev.
##  ZIPREGION (Intercept) 0.13502</code></pre>
</div>
<div id="interpreting-odds-ratios" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Interpreting odds ratios<a href="multilevel-logistic-regression.html#interpreting-odds-ratios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When interpreting results from generalized linear mixed effects models, nothing changes when we don’t use the inverse transformation. That is, the results below can be interpreted as normal:</p>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
HOSPERA 2
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Log-Odds
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
std. Error
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.65
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.13
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
SEX01 [Female]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.054
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
RESPAGE_4CAT35-49
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.12
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.424
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
RESPAGE_4CAT50-64
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.12
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.266
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
RESPAGE 4CAT [65+]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.01
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.924
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
BMI
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.12
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
RESPRACE 4CAT [Black]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.39
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
RESPRACE 4CAT [Asian]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.30
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.26
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.247
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
RESPRACE 4CAT [Other]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.37
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
NPOV100 [Not in poverty]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.56
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N <sub>ZIPREGION</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
31
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
6927
</td>
</tr>
</table>
<ul>
<li>So for example, holding age, BMI, race and poverty status constant, the log-odds of an ED visit is increase by <span class="math inline">\(0.11\)</span> for females compared to males.</li>
</ul>
<p>However, for the odds ratios, we have to exponentiate. This is a non-linear transformation and brings the model back to it’s non-linear form.</p>
<ul>
<li>As discussed, we can obtain odds ratios and confidence intervals, but bootstrap or even profile-likelihood-based intervals can take a while to return. For now, we’ll use the <code>Confint</code> function from <code>car</code> which is based simply on the normal approximation to the log-odds betas</li>
</ul>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="multilevel-logistic-regression.html#cb355-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">exp</span>(car<span class="sc">::</span><span class="fu">Confint</span>(cond_mod)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                       Estimate 2.5 % 97.5 %
## (Intercept)              0.525 0.409  0.673
## SEX01Female              1.116 0.998  1.247
## RESPAGE_4CAT35-49        0.910 0.722  1.147
## RESPAGE_4CAT50-64        0.889 0.723  1.094
## RESPAGE_4CAT65+          0.990 0.808  1.214
## scale(BMI)               1.131 1.072  1.192
## RESPRACE_4CATBlack       1.470 1.266  1.706
## RESPRACE_4CATAsian       0.738 0.442  1.234
## RESPRACE_4CATOther       1.449 1.170  1.795
## NPOV100Not in poverty    0.570 0.489  0.664</code></pre>
<p>Above, we must now interpret the association between sex and odds of ED visit as follows:</p>
<blockquote>
<p>Holding all other variables constant, and the cluster / random effect constant, females have <span class="math inline">\(12\%\)</span> greater odds of an ED visit compared to males</p>
</blockquote>
<p>This is why the mixed-effects logistic regression is referred to as “cluster-specific” (compared to say, GEE which is a “population average model”)</p>
<p>Greater insight to this issue can be found <a href="https://stats.oarc.ucla.edu/other/mult-pkg/introduction-to-generalized-linear-mixed-models/">here</a> and we’ll briefly look at an example.</p>
<p>Here’s a histogram of the predicted probabilities of ED visit holding the random effect constant at <span class="math inline">\(-0.0581\)</span> which is the 25th percentile of the random effects:</p>
<p><img src="_main_files/figure-html/hist11-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## [1] 0.2302176</code></pre>
<p>And now here’s a histogram of the predictions at the 75th percentile, a random effect of <span class="math inline">\(0.062\)</span></p>
<p><img src="_main_files/figure-html/hist211-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## [1] 0.2521749</code></pre>
<p>The distributions are slightly different, but the median predicted probability is about the same. So in this case, there isn’t a ton of variability due to the cluster, after conditioning on the within-cluster variables. So the fixed effects do carry some weight.</p>
<p>If, however, the distribution shifted quite a bit, we might conclude that although within a particular zipcode region, it would be good to focus on individual variables to potentially intervene to reduce ED visits, at it may be better to focus on equity efforts between low and high risk regions</p>
<p>We will discuss this more next week when we compare our results to the “population average model.”</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="longitudinal-models-with-upper-level-predictors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mlm-v.-gee-for-binary-outcomes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
